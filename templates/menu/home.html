{% extends "base.html" %}
{% load static %}

{% block title %}Brew Bloom Coffee ¬∑ Crafted Cups{% endblock %}

{% block content %}
<section class="hero-modern">
    <div class="hero-container">
        <div class="hero-content">
            <h1 class="hero-title">
                <span class="hero-line">Discover</span>
                <span class="hero-line">The Art Of</span>
                <span class="hero-line">Perfect Coffee</span>
            </h1>
            <p class="hero-subhead">
                Experience The Rich And Bold Flavors Of Our Exquisite Coffee Blends, Crafted To Awaken Your Senses And Start Your Day Right
            </p>
            <div class="hero-actions">
                <a href="#menu" class="cta-btn-primary">Explore Menu</a>
                <a href="{% url 'make_reservation' %}" class="cta-btn-secondary">Reserve Table</a>
            </div>
        </div>
        <div class="hero-image">
            <div class="coffee-carousel">
                <div class="carousel-container">
                    <img src="https://images.unsplash.com/photo-1517487881594-2787fef5ebf7?w=800&q=80" alt="Coffee beans splashing into cup" class="carousel-img active">
                    <img src="https://images.unsplash.com/photo-1461023058943-07fcbe16d735?w=800&q=80" alt="Coffee cup" class="carousel-img">
                    <img src="https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=800&q=80" alt="Coffee beans" class="carousel-img">
                    <img src="https://images.unsplash.com/photo-1510591509098-f4fdc6d0ff04?w=800&q=80" alt="Coffee preparation" class="carousel-img">
                    <img src="https://images.unsplash.com/photo-1572442388796-11668a67e53d?w=800&q=80" alt="Latte art" class="carousel-img">
                </div>
                <div class="carousel-indicators">
                    <span class="indicator active" data-slide="0"></span>
                    <span class="indicator" data-slide="1"></span>
                    <span class="indicator" data-slide="2"></span>
                    <span class="indicator" data-slide="3"></span>
                    <span class="indicator" data-slide="4"></span>
                </div>
            </div>
            <div class="hero-branding">BB</div>
        </div>
    </div>
</section>

<section id="highlights" class="highlight-grid">
    <article class="highlight-card">
        <h3>{{ highlights.tagline }}</h3>
        <p>{{ highlights.hours }}</p>
    </article>
    <article class="highlight-card">
        <h3>Find us</h3>
        <p>{{ highlights.address }}</p>
    </article>
    <article class="highlight-card">
        <h3>Call ahead</h3>
        <p>{{ highlights.phone }}</p>
    </article>
</section>

<section class="service-flow" id="delivery">
    <div class="section-heading">
        <p class="kicker">Delivery ¬∑ Order ¬∑ Shopping</p>
        <h2>Choose how the coffee ritual meets you</h2>
        <p>Inspired by modern retail flows from <a href="https://www.sketchflow.ai/share/88D78A90E2B244799CA17926DF0A3B9E" target="_blank" rel="noopener">SketchFlow</a>, we built ultra-clear options for every guest journey.</p>
    </div>
    <div class="service-flow-grid">
        <article class="service-card">
            <div class="service-icon">üõçÔ∏è</div>
            <h3>Order & Shop</h3>
            <p>Curate beans, merch, and house syrups online. Pick up in-store or have a courier drop it off.</p>
            <ul>
                <li>Live inventory from our bar</li>
                <li>Priority queue for pre-orders</li>
                <li>Shareable shopping lists</li>
            </ul>
        </article>
        <article class="service-card">
            <div class="service-icon">üö≤</div>
            <h3>Delivery Moments</h3>
            <p>Messenger partners keep pours upright from our bar to your door with thermal carriers.</p>
            <ul>
                <li>Live rider tracking via SMS</li>
                <li>Heat-safe packaging</li>
                <li>Estimated arrival 30-40 mins</li>
            </ul>
        </article>
        <article class="service-card">
            <div class="service-icon">ü™ë</div>
            <h3>Dine-in & Reservations</h3>
            <p>Reserve tasting flights, team off-sites, or hold a table. Only confirmed guests can view itineraries.</p>
            <ul>
                <li>Private cupping menus</li>
                <li>Custom playlists & lighting</li>
                <li>Concierge for groups 6+</li>
            </ul>
        </article>
        <article class="service-card">
            <div class="service-icon">üì¶</div>
            <h3>Subscriptions & Gifts</h3>
            <p>Set-and-forget deliveries of seasonal beans with brewer cards and brewing ratios.</p>
            <ul>
                <li>Rotating single origins</li>
                <li>Discount codes for members</li>
                <li>Skip or pause anytime</li>
            </ul>
        </article>
    </div>
    <div class="service-flow-actions">
        <a href="{% url 'checkout' %}" class="cta-btn primary">Start an Order</a>
        <a href="{% url 'make_reservation' %}" class="cta-btn ghost">Plan a Visit</a>
    </div>
</section>

<section id="menu" class="menu-section">
    <div class="section-heading">
        <p class="kicker">Signature pours</p>
        <h2>Modern classics & seasonal innovations</h2>
        <p>Each recipe is dialed in daily to highlight the terroir of the bean and the craft of our baristas.</p>
    </div>
    
    <!-- Search and Filter Bar -->
    <div class="menu-filters">
        <form method="get" action="{% url 'home' %}#menu" class="filter-form">
            <div class="filter-group">
                <input type="text" name="search" value="{{ search_query }}" placeholder="Search coffees..." class="search-input">
            </div>
            <div class="filter-group">
                <select name="origin" class="filter-select">
                    <option value="">All Origins</option>
                    {% for origin in all_origins %}
                    <option value="{{ origin }}" {% if filter_origin == origin %}selected{% endif %}>{{ origin }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="filter-group">
                <select name="strength" class="filter-select">
                    <option value="">All Strengths</option>
                    {% for strength in all_strengths %}
                    <option value="{{ strength }}" {% if filter_strength == strength %}selected{% endif %}>{{ strength }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="filter-group">
                <select name="sort" class="filter-select">
                    <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Sort by Name</option>
                    <option value="price_low" {% if sort_by == 'price_low' %}selected{% endif %}>Price: Low to High</option>
                    <option value="price_high" {% if sort_by == 'price_high' %}selected{% endif %}>Price: High to Low</option>
                </select>
            </div>
            <button type="submit" class="filter-btn">Filter</button>
            {% if search_query or filter_origin or filter_strength %}
            <a href="{% url 'home' %}#menu" class="clear-btn">Clear</a>
            {% endif %}
        </form>
    </div>
    
    {% if search_query or filter_origin or filter_strength %}
    <div class="filter-results">
        <p>Found <strong>{{ coffees|length }}</strong> coffee{{ coffees|length|pluralize }}</p>
    </div>
    {% endif %}
    
    <div class="menu-grid" id="menu-grid">
        {% for coffee in coffees %}
        <article class="menu-card">
            <div class="menu-card-image">
                {% if coffee.image %}
                <img src="{{ coffee.image }}" alt="{{ coffee.name }}" loading="lazy">
                {% else %}
                <div class="menu-image-placeholder">‚òï</div>
                {% endif %}
            </div>
            <div class="menu-card-content">
                <p class="menu-origin">{{ coffee.origin }}</p>
                <h3>{{ coffee.name }}</h3>
                <p class="menu-notes">{{ coffee.notes }}</p>
                <div class="menu-meta">
                    <span class="menu-strength">{{ coffee.strength }}</span>
                    <span class="menu-price">${{ coffee.price|floatformat:2 }}</span>
                </div>
                <form method="post" action="{% url 'add_to_cart' coffee.id %}" class="add-to-cart-form" data-coffee-id="{{ coffee.id }}">
                    {% csrf_token %}
                    <button type="submit" class="add-to-cart-btn" data-coffee-name="{{ coffee.name }}">
                        <span class="btn-text">Add to Cart</span>
                        <span class="btn-loading" style="display: none;">Adding...</span>
                    </button>
                </form>
            </div>
        </article>
        {% endfor %}
    </div>
</section>

<section id="experiences" class="experiences">
    <div class="section-heading">
        <p class="kicker">Beyond the bar</p>
        <h2>Experiences & community</h2>
        <p>Reserve immersive tastings, team coffee rituals, and custom catering for gatherings.</p>
    </div>
    <ul class="experience-list">
        {% for experience in experiences %}
        <li>{{ experience }}</li>
        {% endfor %}
    </ul>
</section>

<section class="testimonials">
    {% for testimonial in testimonials %}
    <blockquote>
        <p>‚Äú{{ testimonial.quote }}‚Äù</p>
        <cite>‚Äî {{ testimonial.name }}</cite>
    </blockquote>
    {% endfor %}
</section>

<section id="visit" class="visit-cta">
    <div>
        <p class="kicker">Visit us</p>
        <h2>Need beans for the office or a full espresso cart?</h2>
        <p>We curate wholesale partnerships, host off-site popups, and roast custom blends.</p>
    </div>
    <a href="mailto:hello@brewbloom.cafe" class="cta-btn primary">Book a tasting</a>
</section>

<script>
// Image Carousel Functionality
document.addEventListener('DOMContentLoaded', function() {
    const images = document.querySelectorAll('.carousel-img');
    const indicators = document.querySelectorAll('.indicator');
    let currentIndex = 0;
    const intervalTime = 4000; // 4 seconds
    
    function showSlide(index) {
        // Hide all images
        images.forEach(img => img.classList.remove('active'));
        indicators.forEach(ind => ind.classList.remove('active'));
        
        // Show current image
        if (images[index]) {
            images[index].classList.add('active');
        }
        if (indicators[index]) {
            indicators[index].classList.add('active');
        }
    }
    
    function nextSlide() {
        currentIndex = (currentIndex + 1) % images.length;
        showSlide(currentIndex);
    }
    
    // Auto-advance carousel
    setInterval(nextSlide, intervalTime);
    
    // Indicator click handlers
    indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', function() {
            currentIndex = index;
            showSlide(currentIndex);
        });
    });
});
</script>
{% endblock %}

